with table_name as (select 
a.client_id,
extract (Day from a.BANK_DATE) as gun,
extract (Month from a.BANK_DATE) as ay,
extract (Year from a.BANK_DATE) as il, 
count(unique a.op_id) say,
dense_RANK() OVER(      PARTITION BY a.client_id ORDER BY count(unique a.op_id) DESC) ranks
from birbank.f_operation a
where a.source_type = '1' 
and a.destination_type = '12' 
and a.op_status = 1
and a.op_date between '01-Jan-22' and '01-Jan-23' 
group by a.client_id,
extract (Month from a.BANK_DATE),
extract (Day from a.BANK_DATE),
extract (Year from a.BANK_DATE))

select * from table_name where ranks=1 order by say desc



select a.*  
from birbank.f_operation a
where a.source_type = '1' 
and a.destination_type = '12' 
and a.op_status = 1
and a.client_id = 334425
and a.bank_date = to_date('02.03.2022','dd.mm.yyyy')


select 
a.client_id,
extract (Day from a.BANK_DATE) as gun,
extract (Month from a.BANK_DATE) as ay,
extract (Year from a.BANK_DATE) as il, 
a.BANK_DATE,
count(unique a.op_id) say
from birbank.f_operation a
where a.source_type = '1' 
and a.destination_type = '12' 
and a.op_status = 1
and a.op_date between '01-Jan-22' and '01-Jan-23' 
group by a.client_id,
extract (Month from a.BANK_DATE),
extract (Day from a.BANK_DATE),
extract (Year from a.BANK_DATE),
a.BANK_DATE
order by say desc;
