SELECT /* parallel*/
 b.pin, b.full_name, a.create_date, product_name, count(*) as say
  FROM CMS.d_card a
 inner join dwh.d_customer b
    on a.cms_id = b.cms_id
 where a.create_date >= to_date('2019', 'yyyy')
   and a.close_date > to_date(sysdate, 'dd.mm.yyyy')
   and a.product_name in ('Visa Electron Sosial Yardim2',
                          'Visa Electron Sosial Yardim',
                          'Visa Electron Unvanli Social',
                          'Maestro Unvanli Social',
                          'Maestro Social')
 group by b.pin, b.full_name, a.create_date, product_name
having count(*) > 1
 order by say desc offset 5 rows;
