select A.VALUE_DATE,
       B.FULL_NAME AS GONDEREN,
       B.PIN AS GONDEREN_PIN,
       A.PAN AS ALAN_PAN,
       D.FULL_NAME AS ALAN,
       D.PIN AS ALAN_PIN,
       C.PAN AS GONDEREN_PAN,
       A.LCY_AMOUNT
  from cms.f_transaction_details A INNER JOIN cms.d_customer B ON A.IDCLIENT = B.CMS_ID
  INNER JOIN cms.f_transaction_details C ON A.INVOICE=C.INVOICE 
  INNER JOIN cms.d_customer D ON C.IDCLIENT = D.CMS_ID
 WHERE A.ENTCODE = '32'
   AND C.ENTCODE = '33'
   AND A.value_date = TO_DATE('10.04.2022', 'dd.mm.yyyy')
   AND A.TERMCODE = '42271'
   AND A.Term = 'BirBank10'
   AND D.PIN='60CFME6';
---------
select a.value_date,
       a.pan as gonderen_pan,
       a.accountnoone AS gonderen,
       c.full_name as Gonderenin_adi,
       d.full_name as Qebuledenin_Adi,
       B.PAN as qebuleden_pan,
       B.ACCOUNTNOONE as gebul_eden ,
       a.org_amount,
       a.org_currency,
       a.fcy_amount,
       a.currency    
  from       cms.f_transaction_details A 
  inner join cms.f_transaction_details B  on A.Invoice = b.Invoice
  inner join cms.d_customer c on a.idclient = c.cms_id 
  inner join cms.d_customer D on b.idclient = d.cms_id 
 where a.value_date between to_date('01.12.2022','dd.mm.yyyy') and to_date('31.01.2023','dd.mm.yyyy')
   and a.entcode = '32'
   AND B.ENTCODE = '33'
   AND A.TERMCODE = '42271';

----------------------------------------------------
select /* +parallel*/
       Alan.value_date,
       Alanc.full_name as Gonderenin_adi,
       QebulEdend.full_name as Qebuledenin_Adi,
       QebulEdendEmp.fin as QebulEdenFini,
       Alan.pan as gonderen_pan,
       QebulEden.PAN as qebuleden_pan,
       Alan.accountnoone AS gonderen,
       QebulEden.ACCOUNTNOONE as gebul_eden_account ,
       Alan.org_amount,
       Alan.org_currency,
       Alan.fcy_amount,
       Alan.currency    
        from cms.f_transaction_details Alan
  inner join cms.f_transaction_details QebulEden  on Alan.Invoice = QebulEden.Invoice
  inner join cms.d_customer Alanc on Alan.idclient = Alanc.cms_id 
  inner join cms.d_customer QebulEdend on QebulEden.idclient = QebulEdend.cms_id 
  inner join fraud.emp_2 QebulEdendEmp on QebulEdend.pin=QebulEdendEmp.fin
 where Alan.value_date between to_date('01.01.2022','dd.mm.yyyy') and to_date('01.02.2023','dd.mm.yyyy')
   and Alan.entcode = '32'
   AND QebulEden.ENTCODE = '33'
   AND Alan.TERMCODE = '42271';
--------------------
select /* +parallel*/
       Alan.value_date,
       Alanc.full_name as Gonderenin_adi,
       Alanc.Pin as Gonderenin_PINI,
       QebulEdend.full_name as Qebuledenin_Adi,
       QebulEdendEmp.fin as QebulEdenFini,
       Alan.pan as gonderen_pan,
       QebulEden.PAN as qebuleden_pan,
       Alan.accountnoone AS gonderen,
       QebulEden.ACCOUNTNOONE as gebul_eden_account ,
       Alan.org_amount,
       Alan.org_currency,
       Alan.fcy_amount,
       Alan.currency ,
       case when   Alanc.Pin = QebulEdendEmp.fin then 'yes' else 'no' end as useless_cases
        from cms.f_transaction_details Alan
  inner join cms.f_transaction_details QebulEden  on Alan.Invoice = QebulEden.Invoice
  inner join cms.d_customer Alanc on Alan.idclient = Alanc.cms_id 
  inner join cms.d_customer QebulEdend on QebulEden.idclient = QebulEdend.cms_id 
  inner join fraud.emp_2 QebulEdendEmp on QebulEdend.pin=QebulEdendEmp.fin
where Alan.value_date between to_date('01.01.2022','dd.mm.yyyy') and to_date('05.05.2023','dd.mm.yyyy')
   and Alan.entcode = '32'
   AND QebulEden.ENTCODE = '33'
   AND Alan.TERMCODE = '42271'
   AND QebulEdendEmp.fin = '60CFME6'
   and Alanc.Pin ='5ZCQUP2';