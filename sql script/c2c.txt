select a.value_date,
       a.pan as gonderen_pan,
       a.accountnoone AS gonderen,
       c.full_name as Gonderenin_adi,
       d.full_name as Qebuledenin_Adi,
       B.PAN as qebuleden_pan,
       B.ACCOUNTNOONE as gebul_eden ,
       a.org_amount,
       a.org_currency,
       a.fcy_amount,
       a.currency    
  from       cms.f_transaction_details A 
  inner join cms.f_transaction_details B  on A.Invoice = b.Invoice
  inner join cms.d_customer c on a.idclient = c.cms_id 
  inner join cms.d_customer D on b.idclient = d.cms_id 
 where a.value_date between to_date('01.12.2022','dd.mm.yyyy') and to_date('31.01.2023','dd.mm.yyyy')
   and a.entcode = '32'
   AND B.ENTCODE = '33'
   AND A.TERMCODE = '42271';

----------------------------------------------------
select /* +parallel*/
       Alan.value_date,
       Alanc.full_name as Gonderenin_adi,
       QebulEdend.full_name as Qebuledenin_Adi,
       QebulEdendEmp.fin as QebulEdenFini,
       Alan.pan as gonderen_pan,
       QebulEden.PAN as qebuleden_pan,
       Alan.accountnoone AS gonderen,
       QebulEden.ACCOUNTNOONE as gebul_eden_account ,
       Alan.org_amount,
       Alan.org_currency,
       Alan.fcy_amount,
       Alan.currency    
        from cms.f_transaction_details Alan
  inner join cms.f_transaction_details QebulEden  on Alan.Invoice = QebulEden.Invoice
  inner join cms.d_customer Alanc on Alan.idclient = Alanc.cms_id 
  inner join cms.d_customer QebulEdend on QebulEden.idclient = QebulEdend.cms_id 
  inner join fraud.emp_2 QebulEdendEmp on QebulEdend.pin=QebulEdendEmp.fin
 where Alan.value_date between to_date('01.01.2022','dd.mm.yyyy') and to_date('01.02.2023','dd.mm.yyyy')
   and Alan.entcode = '32'
   AND QebulEden.ENTCODE = '33'
   AND Alan.TERMCODE = '42271';