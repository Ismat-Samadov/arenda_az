select a.create_date,
       a.create_time,
       a.by_otp,
       a.label,
       a.state,
       a.type,
       a.user_id,
       C.PIN,
       C.MOBILE,
       B.CARD_NUMBER,
       B.NAME,
       B.SURNAME,
       B.AMOUNT,
       B.COMMISSION_STATE,
       D.FROMACCT
  from taxrefund.f_transaction A
 inner join taxrefund.f_transfer B
    on A.ID = B.OPERATION_ID
 inner join taxrefund.d_customer C
    on A.USER_ID = C.ID
 inner join cms.f_tla_cmp D
    on B.TRANSACTION_ID = D.ID
    where c.pin in  (select A.pin
                 from cms.d_customer A
                where A.cms_id in (select m.credit_cms_id
                                     from cms.f_transaction m
                                    where m.debitentcode = '3'
                                      and m.credit_cms_id in
                                          (select z.cms_id
                                             from cms.d_card z
                                            where z.ministry_code = '037'
                                              and z.product_code = '3')
                                      and m.value_date between '29-Dec-22' and
                                          '31-Dec-22')) and a.create_date between '01-Dec-22' and '31-Dec-22'
 --where D.FROMACCT IN (SELECT ACCOUNT FROM CMS.D_CARD where PRODUCT_CODE = '2255')
 --ORDER BY A.CREATE_TIME DESC;
